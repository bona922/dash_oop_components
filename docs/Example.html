---

title: Covid Dashboard Example


keywords: fastai
sidebar: home_sidebar

summary: "A small example showing the power of dash_oop_components in building a modular covid tracking dashboard"
description: "A small example showing the power of dash_oop_components in building a modular covid tracking dashboard"
nb_path: "01_Example.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_Example.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This dashboard has been deployed to <a href="https://dash-oop-demo.herokuapp.com/">https://dash-oop-demo.herokuapp.com/</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dashboard-Design">Dashboard Design<a class="anchor-link" href="#Dashboard-Design"> </a></h1><p>The dashboard consists one <a href="/dash_oop_components/core.html#DashFigureFactory"><code>DashFigureFactory</code></a> and four <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a>s.</p>
<ol>
<li><strong>CovidPlots</strong>: <a href="/dash_oop_components/core.html#DashFigureFactory"><code>DashFigureFactory</code></a> that stores a covid dataset and can plot both timeseries and piecharts for a select number of countries for either cases or deaths.</li>
<li><strong>CovidTimeSeries</strong>: a component with a deaths/cases and a country dropdown that displays the timeseries plot</li>
<li><strong>CovidPieChart</strong>: a component with a deaths/cases and a country dropdown that displays the pie chart plot</li>
<li><strong>CovidComponent</strong>: a component that combines a <code>CovidTimeSeries</code> and a <code>CovidPieChart</code>, and adds its own dropdowns that control both subcomponents</li>
<li><strong>CovidDashboard</strong>: a dashboard consisting of four <code>CovidComponent</code>s in four different tabs:<ol>
<li>One showing only european countries</li>
<li>One showing only Asian countries</li>
<li>One showing only cases</li>
<li>One showing only deaths</li>
</ol>
</li>
</ol>
<p>So the <code>CovidComponent</code> gets re-used four times, with different configurations. And each <code>CovidComponent</code> reuses <code>CovidTimeSeries</code> and <code>CovidPieChart</code>.</p>
<p>The <code>CovidPlots</code> figure factory gets passed down by the <code>CovidDashboard</code> to the <code>CovidComponents</code>, and by the <code>CovidComponents</code> to the <code>CovidTimeSeries</code> and <code>CovidPieChart</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Running-the-dashboard">Running the dashboard<a class="anchor-link" href="#Running-the-dashboard"> </a></h1><p>We run the dashboard by passing the <code>CovidDashboard</code> to a <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a> and calling <code>.run()</code>.</p>
<p>We can store the configuration with <code>dashboard.to_yaml("covid_dashboard.yaml")</code>.</p>
<p>And then build a new <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a> instance directly from that configuration with `DashApp.from_yaml("covid_dashboard.yaml")</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CovidPlots">CovidPlots<a class="anchor-link" href="#CovidPlots"> </a></h2><p>First we build a plot factory that holds the dataframe, and has two plotting functions:</p>
<ul>
<li><code>plot_time_series</code>: plots a time series for a given list of countries for a given metric ('cases' or 'deaths')</li>
<li><code>plot_pie_chart</code>: plots a pie chart for a given list of countries for a given metric ('cases' or 'deaths')</li>
</ul>
<p>We store a list of countries and metrics to <code>self.countries</code> and <code>self.metric</code>, so that the components can use those to populate the dropdowns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CovidPlots</span><span class="p">(</span><span class="n">DashFigureFactory</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datafile</span><span class="o">=</span><span class="s2">&quot;covid.csv&quot;</span><span class="p">,</span> <span class="n">exclude_countries</span><span class="o">=</span><span class="p">[]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude_countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">countriesAndTerritories</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">exclude_countries</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">countriesAndTerritories</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cases&#39;</span><span class="p">,</span> <span class="s1">&#39;deaths&#39;</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">plot_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
            <span class="n">data_frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">countriesAndTerritories</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)],</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;dateRep&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;countriesAndTerritories&#39;</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;countriesAndTerritories&#39;</span><span class="p">:</span><span class="s1">&#39;Countries&#39;</span><span class="p">,</span> <span class="s1">&#39;dateRep&#39;</span><span class="p">:</span><span class="s1">&#39;date&#39;</span><span class="p">},</span>
            <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">plot_pie_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span>
            <span class="n">data_frame</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">countriesAndTerritories</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)],</span>
            <span class="n">names</span><span class="o">=</span><span class="s1">&#39;countriesAndTerritories&#39;</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="n">hole</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;countriesAndTerritories&#39;</span><span class="p">:</span><span class="s1">&#39;Countries&#39;</span><span class="p">}</span>
            <span class="p">)</span> 
    
<span class="n">plot_factory</span> <span class="o">=</span> <span class="n">CovidPlots</span><span class="p">(</span><span class="n">datafile</span><span class="o">=</span><span class="s2">&quot;covid.csv&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dash_figure_factory:
  name: CovidPlots
  module: __main__
  params:
    datafile: covid.csv
    exclude_countries: []

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CovidTimeSeries">CovidTimeSeries<a class="anchor-link" href="#CovidTimeSeries"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>CovidTimeSeries</code> component consisting of:</p>

<pre><code>- A dropdown to select a number of countries
- A dropdown to select cases or deaths
- a time series plot

</code></pre>
<p>All parameters are automatically assigned to attributes. So we can simply use <code>self.plot_factory</code> or <code>self.countries</code> with having to specify the assignments in the <code>__init__</code>.</p>
<p>Both dropdowns can be hidden by passing <code>hide_country_dropdown=True</code> or <code>hide_metric_dropdown=True</code>. This works
by using the <code>make_hideable()</code> staticmethod from the <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a> class: We wrap the relevant part of the layout in a <code>self.make_hideable(..., hide=self.hide_country_dropdown)</code> wrapper. If <code>hide==True</code> then <code>make_hideable()</code> will wrap a hidden div around the element.</p>
<p>If no <code>include_countries</code> or <code>include_metrics</code> are given, then by default all countries and metrics get included.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CovidTimeSeries</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> 
                 <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">countries</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">metrics</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">H3</span><span class="p">(</span><span class="s2">&quot;Covid Time Series&quot;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;timeseries-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_metric_dropdown</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;timeseries-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">country</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">country</span><span class="p">}</span> <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                            <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_country_dropdown</span><span class="p">),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;timeseries-figure-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="p">]),</span>
            <span class="p">])</span>
        <span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">_register_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;timeseries-figure-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;timeseries-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;timeseries-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">countries</span> <span class="ow">and</span> <span class="n">metric</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">plot_time_series</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">PreventUpdate</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CovidPieChart">CovidPieChart<a class="anchor-link" href="#CovidPieChart"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>CovidPieChart</code> component consisting of:</p>

<pre><code>- A dropdown to select a number of countries
- A dropdown to select cases or deaths
- a pie chart plot

</code></pre>
<p>The first parameter is a <code>CovidPlots</code> <code>DashPlotFactory</code> that will be used to return the right plot in the callbacks.</p>
<p>All parameters are automatically assigned to attributes. So we can simply use <code>self.plot_factory</code> or <code>self.countries</code> with having to specify the assignments in the <code>__init__</code>.</p>
<p>Both dropdowns can be hidden by passing <code>hide_country_dropdown=True</code> or <code>hide_metric_dropdown=True</code>. This works
by using the <code>make_hideable()</code> staticmethod from the <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a> class: We wrap the relevant part of the layout in a <code>self.make_hideable(..., hide=self.hide_country_dropdown)</code> wrapper. If <code>hide==True</code> then <code>make_hideable()</code> will wrap a hidden div around the element.</p>
<p>If no <code>include_countries</code> or <code>include_metrics</code> are given, then by default all countries and metrics get included.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CovidPieChart</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> 
                 <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">countries</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">metrics</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">H3</span><span class="p">(</span><span class="s2">&quot;Covid Pie Chart&quot;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;piechart-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_metric_dropdown</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;piechart-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">country</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">country</span><span class="p">}</span> <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                            <span class="n">multi</span><span class="o">=</span><span class="kc">True</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_country_dropdown</span><span class="p">),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;piechart-figure-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="p">]),</span>
            <span class="p">])</span>
        <span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">_register_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;piechart-figure-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;piechart-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;piechart-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">countries</span> <span class="ow">and</span> <span class="n">metric</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">plot_pie_chart</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">PreventUpdate</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CovidComposite">CovidComposite<a class="anchor-link" href="#CovidComposite"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>CovidComposite</code> combines a <code>CovidTimeSeries</code> and <code>CovidPieChart</code> component into a single composite component.</p>
<ul>
<li>The <code>plot_factory</code> gets passed down to the subcomponents</li>
<li>The subcomponents are included in the layout with <code>self.timeseries.layout()</code> and <code>self.piechart.layout()</code>.</li>
<li>An additional callback is added with <code>def _register_components(self, app)</code> (<strong>note the underscore!</strong>) that connects the dropdowns of the <code>CovidComponent</code> to the dropdowns of the subcomponents. (therefore the subcomponent dropdowns are also hidden by setting <code>hide_country_dropdown=True</code> and <code>hide_metric_dropdown=True</code>)</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CovidComponent</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Covid Analysis&quot;</span><span class="p">,</span>
                 <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">include_countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">include_metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">countries</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">metrics</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span> <span class="o">=</span> <span class="n">CovidTimeSeries</span><span class="p">(</span>
                <span class="n">plot_factory</span><span class="p">,</span> 
                <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">piechart</span> <span class="o">=</span> <span class="n">CovidPieChart</span><span class="p">(</span>
                <span class="n">plot_factory</span><span class="p">,</span> 
                <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_metric_dropdown</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                            <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_country_dropdown</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">],</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">),</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="p">])</span>
        <span class="p">],</span> <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_register_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;timeseries-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;piechart-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;dashboard-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">countries</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">countries</span><span class="p">,</span> <span class="n">countries</span>
        
        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;timeseries-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;piechart-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;dashboard-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">metric</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">metric</span><span class="p">,</span> <span class="n">metric</span>
        
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="CovidDashboard">CovidDashboard<a class="anchor-link" href="#CovidDashboard"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final <code>CovidDashboard</code> consists of four <code>CovidComposites</code> subcomponents, each in its own tab, and each with a slightly different configuration.</p>
<ul>
<li>First tab only shows European counties, by passing <code>include_countries=[...]</code></li>
<li>Second tab only shows Asian countries</li>
<li>Third includes all countries, but only shows cases, and hides the metric dropdown. 
  The default initial countries are ['China', 'Italy', 'Brazil']</li>
<li>Third includes all countries, but only shows deaths, and hides the metric dropdown. 
  The default initial countries are ['China', 'Italy', 'Brazil']</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CovidDashboard</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> 
                 <span class="n">europe_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Italy&#39;</span><span class="p">,</span>  <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">,</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;United_Kingdom&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">,</span> <span class="s1">&#39;Netherlands&#39;</span><span class="p">,</span>  
                                     <span class="s1">&#39;Belgium&#39;</span><span class="p">,</span> <span class="s1">&#39;Austria&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">],</span>
                <span class="n">asia_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Vietnam&#39;</span><span class="p">,</span> <span class="s1">&#39;Malaysia&#39;</span><span class="p">,</span> <span class="s1">&#39;Philippines&#39;</span><span class="p">,</span> 
                                  <span class="s1">&#39;Taiwan&#39;</span><span class="p">,</span> <span class="s1">&#39;Myanmar&#39;</span><span class="p">,</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">,</span> <span class="s1">&#39;South_Korea&#39;</span><span class="p">,</span> <span class="s1">&#39;Japan&#39;</span><span class="p">]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">europe</span> <span class="o">=</span> <span class="n">CovidComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Europe&quot;</span><span class="p">,</span> 
                                     <span class="n">include_countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe_countries</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asia</span> <span class="o">=</span> <span class="n">CovidComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Asia&quot;</span><span class="p">,</span> <span class="n">include_countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia_countries</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span> <span class="o">=</span> <span class="n">CovidComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Cases Only&quot;</span><span class="p">,</span> 
                                         <span class="n">include_metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cases&#39;</span><span class="p">],</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">,</span>
                                         <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">countries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span> <span class="o">=</span> <span class="n">CovidComponent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Deaths Only&quot;</span><span class="p">,</span> 
                                          <span class="n">include_metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deaths&#39;</span><span class="p">],</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;deaths&#39;</span><span class="p">,</span>
                                          <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">countries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">])</span>
        
    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s2">&quot;Covid Dashboard&quot;</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;tabs&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                        <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">layout</span><span class="p">()),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">layout</span><span class="p">()),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">layout</span><span class="p">()),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">layout</span><span class="p">()),</span>
                        <span class="p">]),</span>
                <span class="p">])</span>
            <span class="p">])</span>
        <span class="p">],</span> <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">dashboard</span> <span class="o">=</span> <span class="n">CovidDashboard</span><span class="p">(</span><span class="n">plot_factory</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dashboard</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dash_component:
  name: CovidDashboard
  module: __main__
  params:
    plot_factory:
      dash_figure_factory:
        name: CovidPlots
        module: __main__
        params:
          datafile: covid.csv
          exclude_countries: []
    europe_countries:
    - Italy
    - Spain
    - Germany
    - France
    - Iran
    - United_Kingdom
    - Switzerland
    - Netherlands
    - Belgium
    - Austria
    - Portugal
    - Norway
    asia_countries:
    - China
    - Vietnam
    - Malaysia
    - Philippines
    - Taiwan
    - Myanmar
    - Thailand
    - South_Korea
    - Japan

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Start-app">Start app<a class="anchor-link" href="#Start-app"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pass the <code>dashboard</code> to the <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a>, and add the bootstrap stylesheet that is needed to correctly display all the <code>dbc.Row</code>s and <code>dbc.Col</code>s:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">DashApp</span><span class="p">(</span><span class="n">dashboard_component</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span><span class="n">dbc</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">BOOTSTRAP</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And finally we run the app:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># remove to run</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Store-App-config-and-reload">Store App config and reload<a class="anchor-link" href="#Store-App-config-and-reload"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check out the configuration that was generated for our dashboard. 
This includes:</p>
<ul>
<li>What the topline dashboard_component is, from where to import it and with which parameters to start it</li>
<li>The <code>plot_factory</code> parameter gets automatically replaced with the configuration for the plot_factory:<ul>
<li>includes information on how to import and all parameters</li>
</ul>
</li>
<li>The default list of parameters for <code>europe_countries</code> and <code>asia_countries</code> is included</li>
<li>The parameters for the <code>dash_app</code> itself:<ul>
<li>port=8050</li>
<li>mode='dash'</li>
<li>external_stylesheets=dbc.themes.BOOTSTRAP</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dash_app:
  name: DashApp
  module: dash_oop_components.core
  params:
    dashboard_component:
      dash_component:
        name: CovidDashboard
        module: __main__
        params:
          plot_factory:
            dash_figure_factory:
              name: CovidPlots
              module: __main__
              params:
                datafile: covid.csv
                include_countries: []
          europe_countries:
          - Italy
          - Spain
          - Germany
          - France
          - Iran
          - United_Kingdom
          - Switzerland
          - Netherlands
          - Belgium
          - Austria
          - Portugal
          - Norway
          asia_countries:
          - China
          - Vietnam
          - Malaysia
          - Philippines
          - Taiwan
          - Myanmar
          - Thailand
          - South_Korea
          - Japan
    port: 8050
    mode: dash
    kwargs:
      external_stylesheets:
      - https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can store this configuration to disk:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="s2">&quot;covid_dashboard.yaml&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And reload another <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a> from this configuration. This means that:</p>
<ul>
<li>The releve3nt <a href="/dash_oop_components/core.html#DashFigureFactory"><code>DashFigureFactory</code></a>s will get imported, instantiated with the right parameters and passed down to the <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a>.</li>
<li>The <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a>s will get imported from the right module, passed an instantiated <a href="/dash_oop_components/core.html#DashFigureFactory"><code>DashFigureFactory</code></a> along with other parameters.</li>
<li>Either a <code>dash.Dash()</code> or a <code>jupyter_dash.JupyterDash()</code> app gets started, depending on <code>mode</code>.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app2</span> <span class="o">=</span> <span class="n">DashApp</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">(</span><span class="s2">&quot;covid_dashboard.yaml&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check that the configuration of this new <code>app2</code> is indeed the same as <code>app</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">app2</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dash_app:
  name: DashApp
  module: dash_oop_components.core
  params:
    dashboard_component:
      dash_component:
        name: CovidDashboard
        module: __main__
        params:
          plot_factory:
            dash_figure_factory:
              name: CovidPlots
              module: __main__
              params:
                datafile: covid.csv
                include_countries: []
          europe_countries:
          - Italy
          - Spain
          - Germany
          - France
          - Iran
          - United_Kingdom
          - Switzerland
          - Netherlands
          - Belgium
          - Austria
          - Portugal
          - Norway
          asia_countries:
          - China
          - Vietnam
          - Malaysia
          - Philippines
          - Taiwan
          - Myanmar
          - Thailand
          - South_Korea
          - Japan
    port: 8050
    mode: dash
    kwargs:
      external_stylesheets:
      - https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And if we run it it still works!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># remove to run</span>
    <span class="n">app2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

