---

title: Tracking state of your app in url querystrings


keywords: fastai
sidebar: home_sidebar

summary: "instructions on how to track the state of your dashboard in the url querystring"
description: "instructions on how to track the state of your dashboard in the url querystring"
nb_path: "02_querystrings.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_querystrings.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Make-shareable-dashboards-by-tracking-state-in-url-querystrings">Make shareable dashboards by tracking state in url querystrings<a class="anchor-link" href="#Make-shareable-dashboards-by-tracking-state-in-url-querystrings"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a lot of analytical web apps it can be super useful to be able to share the state of a dashboard with others through a url. Imagine you have done a particular analysis on a particular tab, setting certain dropdowns and toggles and you wish to share these with a co-worker.</p>
<p>You could tell them to go to the dashboard with instructions to set the exact same dropdowns and toggles. But it would be much easier if you can simply send a url that rebuild the dashboard exactly as you saw it!</p>
<p>This can be done by storing the state of the dashboard in the querystring:</p>
<p><img src="/dash_oop_components/dash_oop_demo.gif" alt="QuerystringDemo"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tracking-state-with-dash_oop_components">Tracking state with <code>dash_oop_components</code><a class="anchor-link" href="#Tracking-state-with-dash_oop_components"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thanks to the modular nature and tree structure of <code>DashComponents</code> it is relatively straightforward to keep track of 
which elements should be tracked in the url querystring, and rebuild the page in accordance with the state of the querystring.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An example dashboard that demonstrates how to build a dashboard with querystrings included can be found at <a href="https://github.com/oegedijk/dash_oop_demo">github.com/oegedijk/dash_oop_demo</a> and has been deployed to <a href="https://dash-oop-demo.herokuapp.com/">https://dash-oop-demo.herokuapp.com/</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-summary-instructions:">Basic summary instructions:<a class="anchor-link" href="#Basic-summary-instructions:"> </a></h2><p>In order to add querystring support to your app all you need is to:</p>
<ol>
<li>Pass <code>querystrings=True</code> parameters to <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a> </li>
<li>Change the <code>def layout(self)</code> method to <code>def layout(self, params=None)</code></li>
<li>Inside your <code>DashComponents</code> wrap the elements that you want to track in <code>self.querystring(params)(...)</code>:<ul>
<li>i.e. change <div class="highlight"><pre><span></span><span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;input-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
  to <div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;input-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="s1">&#39;)</span>
</pre></div>
</li>
</ul>
</li>
<li>pass down <code>params</code> to all subcomponent layouts: <div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">subcomponent</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)])</span>
</pre></div>
</li>
</ol>
<p><strong>note:</strong> it is important to assign a proper <code>.name</code> to components with querystring elements, as otherwise the elements will get a different random uuid <code>id</code> each time you reboot the dashboard, breaking old querystrings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-1:-Turning-on-querystrings-in-Dashapp">Step 1: Turning on querystrings in Dashapp<a class="anchor-link" href="#Step-1:-Turning-on-querystrings-in-Dashapp"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to turn on the tracking of querystrings you need to start <a href="/dash_oop_components/core.html#DashApp"><code>DashApp</code></a> 
with the <code>querystrings=True</code> parameter, e.g.:</p>
<div class="highlight"><pre><span></span><span class="n">dashboard</span> <span class="o">=</span> <span class="n">CovidDashboard</span><span class="p">(</span><span class="n">plot_factory</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">DashApp</span><span class="p">(</span><span class="n">dashboard</span><span class="p">,</span> <span class="n">querystrings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span><span class="n">FLATLY</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-2:-Building-DashComponent-with--layout(params)-and-self.querystring()">Step 2: Building <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a> with  <code>layout(params)</code> and <code>self.querystring()</code><a class="anchor-link" href="#Step-2:-Building-DashComponent-with--layout(params)-and-self.querystring()"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The example <a href="https://github.com/oegedijk/dash_oop_demo">dashboard</a> consists of four tabs that each contain the layout of a <code>CovidComposite</code> subcomponent:</p>
<ul>
<li><code>self.europe</code>: a tab with only european countries</li>
<li><code>self.asia</code>: a tab with only Asian countries</li>
<li><code>self.cases_only</code>: a tab with only cases data (for the whole world)</li>
<li><code>self.deaths_only</code>: a tab with only deaths data (for the whole world)</li>
</ul>
<p>In order to keep track of an attribute of a layout element we simply wrap it inside a <code>self.querystring()(element_func)(params)</code> wrapper:</p>
<div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Tabs</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;tabs&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span><span class="err">`</span>
</pre></div>
<p>This will make sure that the <code>value</code> attribute of the <code>dcc.Tabs</code> element with <code>id='tabs'</code> is tracked in the querystring, so that users will start on the same tab when you send them a link.</p>
<p>Other querystring parameters get tracked inside the subcomponent definition of <code>DashComposite</code>. In order to make sure that these subcomponents also receive the <code>params</code> we need to pass those params down to the layout of our subcomponents as well:</p>
<div class="highlight"><pre><span></span><span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
</pre></div>
<p>Note that we set the <code>name</code> of the tabs to <code>"eur"</code>, <code>"asia"</code>, <code>"cases"</code> and <code>"deaths"</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Full definition of <code>CovidDashboard</code>:</strong></p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CovidDashboard</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> 
                 <span class="n">europe_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Italy&#39;</span><span class="p">,</span>  <span class="s1">&#39;Spain&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">,</span> 
                                     <span class="s1">&#39;United_Kingdom&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">,</span> <span class="s1">&#39;Netherlands&#39;</span><span class="p">,</span>  
                                     <span class="s1">&#39;Belgium&#39;</span><span class="p">,</span> <span class="s1">&#39;Austria&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">],</span>
                <span class="n">asia_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Vietnam&#39;</span><span class="p">,</span> <span class="s1">&#39;Malaysia&#39;</span><span class="p">,</span> <span class="s1">&#39;Philippines&#39;</span><span class="p">,</span> 
                                  <span class="s1">&#39;Taiwan&#39;</span><span class="p">,</span> <span class="s1">&#39;Myanmar&#39;</span><span class="p">,</span> <span class="s1">&#39;Thailand&#39;</span><span class="p">,</span> <span class="s1">&#39;South_Korea&#39;</span><span class="p">,</span> <span class="s1">&#39;Japan&#39;</span><span class="p">]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Covid Dashboard&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">europe</span> <span class="o">=</span> <span class="n">CovidComposite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Europe&quot;</span><span class="p">,</span> 
                                     <span class="n">include_countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe_countries</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;eur&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asia</span> <span class="o">=</span> <span class="n">CovidComposite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Asia&quot;</span><span class="p">,</span> 
                                    <span class="n">include_countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia_countries</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;asia&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span> <span class="o">=</span> <span class="n">CovidComposite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Cases Only&quot;</span><span class="p">,</span> 
                                         <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">,</span> <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">countries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cases&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span> <span class="o">=</span> <span class="n">CovidComposite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="p">,</span> <span class="s2">&quot;Deaths Only&quot;</span><span class="p">,</span> 
                                          <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;deaths&#39;</span><span class="p">,</span> <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">countries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;deaths&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s2">&quot;Covid Dashboard&quot;</span><span class="p">),</span>
            <span class="p">]),</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Tabs</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;tabs&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                        <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                        <span class="p">]),</span>
                <span class="p">])</span>
            <span class="p">])</span>
        <span class="p">],</span> <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step-3:-tracking-parameters-in-subcomponents:">Step 3: tracking parameters in subcomponents:<a class="anchor-link" href="#Step-3:-tracking-parameters-in-subcomponents:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>CovidComposite</code> <a href="/dash_oop_components/core.html#DashComponent"><code>DashComponent</code></a> consists of a <code>CovidTimeSeries</code>, a <code>CovidPieChart</code> and two dropdowns for metric and country selection. The value of the dropdowns get passed to the corresponding dropdowns of the subcomponents, which are hidden through the config params.</p>
<p>We would like to keep track of the state of these dropdowns so we wrap them inside a <code>self.querystring()</code>:</p>
<p>For the metric dropdown:</p>
<div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
<p>For the country dropdown:</p>
<div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
<p>And we also make sure that parameters can be passed down the layout with</p>

<pre><code>def layout(self, params=None):
    ...</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Full definition of <code>CovidComposite</code>:</strong></p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CovidComposite</span><span class="p">(</span><span class="n">DashComponent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_factory</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Covid Analysis&quot;</span><span class="p">,</span>
                 <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">include_countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">include_metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cases&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">countries</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">countries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_factory</span><span class="o">.</span><span class="n">metrics</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span> <span class="o">=</span> <span class="n">CovidTimeSeries</span><span class="p">(</span>
                <span class="n">plot_factory</span><span class="p">,</span> 
                <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">piechart</span> <span class="o">=</span> <span class="n">CovidPieChart</span><span class="p">(</span>
                <span class="n">plot_factory</span><span class="p">,</span> 
                <span class="n">hide_country_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                <span class="n">hide_metric_dropdown</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">([</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">)(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_metrics</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metric</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_metric_dropdown</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">make_hideable</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">)(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;dashboard-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">}</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_countries</span><span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">countries</span><span class="p">,</span>
                            <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">),</span> <span class="n">hide</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_country_dropdown</span><span class="p">),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">],</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">),</span>
            <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">([</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">layout</span><span class="p">(),</span>
                <span class="p">],</span> <span class="n">md</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="p">])</span>
        <span class="p">],</span> <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_register_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;timeseries-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;piechart-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;dashboard-country-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">countries</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">countries</span><span class="p">,</span> <span class="n">countries</span>

        <span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;timeseries-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;piechart-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">piechart</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
            <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;dashboard-metric-dropdown-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">update_timeseries_plot</span><span class="p">(</span><span class="n">metric</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">metric</span><span class="p">,</span> <span class="n">metric</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Addendum:-Tracking-querystring-params-of-current-tab-only">Addendum: Tracking querystring params of current tab only<a class="anchor-link" href="#Addendum:-Tracking-querystring-params-of-current-tab-only"> </a></h2><p>When you define dashboard with lots of tabs, lots of components and lots of elements, the size of the querystring can explode rapidly, resulting in clumsy long urls to copy-paste. One solution if to only keep track of the parameters in the current open tab.</p>
<p>The downside is that the rest of the dashboard will take default values, but the upside is significantly smaller querystrings.</p>
<p>In order to implement this, you can make sure of the <a href="/dash_oop_components/core.html#DashComponentTabs"><code>DashComponentTabs</code></a> as a stand-in replacement for <code>dcc.Tabs</code>.</p>
<p>You simply replace</p>
<div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Tabs</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;tabs&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                        <span class="n">children</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                            <span class="n">dcc</span><span class="o">.</span><span class="n">Tab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> 
                                    <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">children</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">params</span><span class="p">)),</span>
                        <span class="p">]),</span>
</pre></div>
<p>with</p>
<div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">querystring</span><span class="p">(</span><span class="n">params</span><span class="p">)(</span><span class="n">DashComponentTabs</span><span class="p">)(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;tabs&quot;</span><span class="p">,</span> 
                        <span class="n">tabs</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">europe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asia</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cases_only</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deaths_only</span><span class="p">],</span>
                        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">single_tab_querystrings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
<p>And automatically all parameters from tabs other than the current tab will be excluded from the url querystring</p>

</div>
</div>
</div>
</div>
 

